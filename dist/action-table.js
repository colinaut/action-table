var m=Object.defineProperty;var b=(l,o,t)=>o in l?m(l,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[o]=t;var c=(l,o,t)=>(b(l,typeof o!="symbol"?o+"":o,t),t);class y extends HTMLElement{constructor(){super();c(this,"tbody");c(this,"ths");c(this,"cols",[]);c(this,"rowsArray")}static get observedAttributes(){return["sort","direction"]}get sort(){var t;return((t=this.getAttribute("sort"))==null?void 0:t.trim().toLowerCase())||""}set sort(t){typeof t=="string"&&this.setAttribute("sort",t)}get direction(){var t;return((t=this.getAttribute("direction"))==null?void 0:t.trim().toLowerCase())||"ascending"}set direction(t){typeof t=="string"&&this.setAttribute("direction",t)}connectedCallback(){const t=this.querySelector("table");this.tbody=t.querySelector("tbody"),this.getColumns(t);const e=this.tbody.querySelectorAll("tbody tr");this.rowsArray=Array.from(e),this.sort&&this.sortTable(),this.addEventListeners()}getColumns(t){return this.ths=t.querySelectorAll("th"),this.ths&&this.ths.forEach(e=>{let s=e.dataset.col||e.innerText||"";if(s=s.trim().toLowerCase(),s){this.cols.push({name:s,index:e.cellIndex});const i=document.createElement("span");i.classList.add("sort-arrow"),e.append(i)}}),this.cols}attributeChangedCallback(t,e,s){}addEventListeners(){this.addEventListener("click",t=>{const e=t.target;if(e.tagName==="TH"){let s=e.dataset.col||e.innerText||"";s=s.trim().toLowerCase(),s&&(this.sort===s&&this.direction==="ascending"?this.direction="descending":(this.sort=s,this.direction="ascending"),this.sortTable())}},!1),this.addEventListener("action-table-filter",t=>{const{col:e,value:s}=t.detail;this.filterTable(e,s)}),this.addEventListener("action-table-filter-reset",()=>{this.resetFilters()})}resetFilters(){this.cols.forEach(e=>{e.filter=""}),this.filterTable();const t=this.querySelectorAll("action-table-filter-menu, action-table-filter-switch");t==null||t.forEach(e=>{e.resetFilter({dispatch:!1})})}filterTable(t="",e=""){t=t==null?void 0:t.trim().toLowerCase(),typeof e=="string"&&(e=e.trim()),this.cols=this.cols.map(s=>(s.name===t&&(s.filter=e),s)),this.rowsArray.forEach(s=>{s.style.display="";const i=s.children;this.cols.forEach(r=>{const d=i[r.index],h=this.getCellContent(d).toString();if(r.filter&&typeof r.filter=="string")new RegExp(r.filter,"i").test(h)||(s.style.display="none");else if(r.filter&&Array.isArray(r.filter)){const a=r.filter;let n="(";a.forEach((f,g)=>{n+=`${f}`,n+=g<a.length-1?"|":""}),n+=")",new RegExp(n,"i").test(h)||(s.style.display="none")}})}),this.sortTable()}getCellContent(t){var s;let e=t.dataset.sort||t.innerText||"";if(e=e==null?void 0:e.trim(),!e){const i=t.firstElementChild;i.tagName.toLowerCase()==="svg"&&(e=((s=i.querySelector("title"))==null?void 0:s.textContent)||"")}return e=Number(e)?Number(e):e.trim(),e}sortTable(t=this.sort,e=this.direction){t=t==null?void 0:t.trim().toLowerCase(),e=e==null?void 0:e.trim().toLowerCase();const s=this.cols.findIndex(i=>i.name===t);s>=0&&this.rowsArray.length>0&&(this.rowsArray.sort((i,r)=>{const d=i.children[s],h=r.children[s];let a=this.getCellContent(d),n=this.getCellContent(h);if(this.direction==="ascending"){if(a<n)return-1;if(a>n)return 1}else{if(a<n)return 1;if(a>n)return-1}return 0}),this.ths.forEach(i=>{var r;i.classList.remove("sort-ascending"),i.classList.remove("sort-descending"),(i.dataset.sort===t||((r=i.innerText)==null?void 0:r.trim().toLowerCase())===t)&&i.classList.add(`sort-${e}`)}),this.rowsArray.forEach(i=>this.tbody.appendChild(i)))}}customElements.define("action-table",y);
//# sourceMappingURL=action-table.js.map
