var u=Object.defineProperty;var f=(d,n,t)=>n in d?u(d,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[n]=t;var o=(d,n,t)=>(f(d,typeof n!="symbol"?n+"":n,t),t);class b extends HTMLElement{constructor(){super();o(this,"shadow");o(this,"table");o(this,"tbody");o(this,"ths");o(this,"cols",[]);o(this,"rows");o(this,"rowsArray");o(this,"rowsArrayFiltered");this.shadow=this.attachShadow({mode:"open"})}static get observedAttributes(){return["sort","direction"]}get sort(){return this.getAttribute("sort")||""}set sort(t){typeof t=="string"&&this.setAttribute("sort",t)}get direction(){return this.getAttribute("direction")||"ascending"}set direction(t){typeof t=="string"&&this.setAttribute("direction",t)}connectedCallback(){var r;this.render();const t=(r=this.shadowRoot)==null?void 0:r.querySelector("slot");if(!t)return;const s=t.assignedElements();this.table=s.filter(e=>e.matches("table")?e:e.querySelector("table")?e.querySelector("table"):!1)[0],this.tbody=this.table.querySelector("tbody"),this.ths=this.table.querySelectorAll("th"),this.ths&&this.ths.forEach(e=>{var l,c;const i=e.dataset.col||((l=e.children[0])==null?void 0:l.getAttribute("title"))||e.textContent||((c=e.children[0])==null?void 0:c.textContent)||"";if(i){this.cols.push({name:i,index:e.cellIndex});const a=document.createElement("span");a.classList.add("sort-arrow"),e.append(a)}}),this.rows=this.table.querySelectorAll("tbody tr"),this.rowsArray=Array.from(this.rows),this.rowsArrayFiltered=this.rowsArray,this.sort&&this.sortTable(),this.addEventListeners()}attributeChangedCallback(t,s,r){}addEventListeners(){this.shadow.addEventListener("click",t=>{var r;const s=t.target;if(s.tagName==="TH"){const e=s.dataset.col||((r=s.children[0])==null?void 0:r.getAttribute("title"))||s.textContent||"";e&&(this.sort===e&&this.direction==="ascending"?this.direction="descending":(this.sort=e,this.direction="ascending"),this.sortTable())}},!1),this.shadow.addEventListener("action-table-filter",t=>{const{col:s,value:r}=t.detail;this.filterTable(s,r)})}filterTable(t="",s=""){this.cols=this.cols.map(r=>(r.name.toLowerCase()===t.toLowerCase()&&(r.filter=s),r)),this.rowsArray.forEach(r=>{r.style.display="";const e=r.children;this.cols.forEach(i=>{var l,c;i.filter&&((((l=e[i.index].textContent)==null?void 0:l.toLowerCase())||((c=e[i.index].dataset.sort)==null?void 0:c.toLowerCase())||"").includes(i.filter.toLowerCase())||(r.style.display="none"))})}),this.sortTable()}getCellSortValue(t){let s=t.dataset.sort||t.textContent||"";return s=s.trim().toLowerCase(),s=Number(s)?Number(s):s,s}sortTable(t=this.sort,s=this.direction){const r=this.cols.findIndex(e=>e.name===t);r>=0&&this.rowsArrayFiltered.length>0&&(this.rowsArray.sort((e,i)=>{const l=e.children[r],c=i.children[r];let a=this.getCellSortValue(l),h=this.getCellSortValue(c);if(this.direction==="ascending"){if(a<h)return-1;if(a>h)return 1}else{if(a<h)return 1;if(a>h)return-1}return 0}),this.ths.forEach(e=>{e.classList.remove("sort-ascending"),e.classList.remove("sort-descending"),e.textContent===t&&e.classList.add(`sort-${s}`)}),this.rowsArray.forEach(e=>this.tbody.appendChild(e)))}render(){const t="<slot></slot>",s="<style></style>";this.shadow.innerHTML=`${s}${t}`}}customElements.define("action-table",b);
//# sourceMappingURL=action-table.js.map
