var m=Object.defineProperty;var u=(l,o,t)=>o in l?m(l,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[o]=t;var c=(l,o,t)=>(u(l,typeof o!="symbol"?o+"":o,t),t);class b extends HTMLElement{constructor(){super();c(this,"tbody");c(this,"ths");c(this,"cols",[]);c(this,"rowsArray")}static get observedAttributes(){return["sort","direction"]}get sort(){var t;return((t=this.getAttribute("sort"))==null?void 0:t.trim().toLowerCase())||""}set sort(t){this.setAttribute("sort",t)}get direction(){var t;return((t=this.getAttribute("direction"))==null?void 0:t.trim().toLowerCase())||"ascending"}set direction(t){this.setAttribute("direction",t)}connectedCallback(){const t=this.querySelector("table");this.tbody=t.querySelector("tbody"),this.getColumns(t);const e=this.tbody.querySelectorAll("tbody tr");this.rowsArray=Array.from(e),this.sort&&this.sortTable(),this.addEventListeners()}getColumns(t){return this.ths=t.querySelectorAll("th"),this.ths&&this.ths.forEach(e=>{let s=e.dataset.col||e.innerText||"";if(s=s.trim().toLowerCase(),s){this.cols.push({name:s,index:e.cellIndex});const r=document.createElement("span");r.classList.add("sort-arrow"),e.append(r)}}),this.cols}attributeChangedCallback(t,e,s){}addEventListeners(){this.addEventListener("click",t=>{const e=t.target;if(e.tagName==="TH"){let s=e.dataset.col||e.innerText||"";s=s.trim().toLowerCase(),s&&(this.sort===s&&this.direction==="ascending"?this.direction="descending":(this.sort=s,this.direction="ascending"),this.sortTable())}},!1),this.addEventListener("action-table-filter",t=>{const{col:e,value:s}=t.detail;this.filterTable(e,s)}),this.addEventListener("action-table-filter-reset",()=>{this.resetFilters()})}resetFilters(){this.cols.forEach(t=>{t.filter=""}),this.filterTable()}filterTable(t="",e=""){t=t==null?void 0:t.trim().toLowerCase(),typeof e=="string"&&(e=e.trim()),this.cols=this.cols.map(s=>(s.name===t&&(s.filter=e),s)),this.rowsArray.forEach(s=>{s.style.display="";const r=s.children;this.cols.forEach(i=>{const d=r[i.index],h=this.getCellContent(d).toString();if(i.filter&&typeof i.filter=="string")new RegExp(i.filter,"i").test(h)||(s.style.display="none");else if(i.filter&&Array.isArray(i.filter)){const a=i.filter;let n="(";a.forEach((f,g)=>{n+=`${f}`,n+=g<a.length-1?"|":""}),n+=")",new RegExp(n,"i").test(h)||(s.style.display="none")}})}),this.sortTable()}getCellContent(t){var s;let e=t.dataset.sort||t.innerText||"";if(e=e==null?void 0:e.trim(),!e){const r=t.firstElementChild;r.tagName.toLowerCase()==="svg"&&(e=((s=r.querySelector("title"))==null?void 0:s.textContent)||"")}return e=Number(e)?Number(e):e.trim(),e}sortTable(t=this.sort,e=this.direction){t=t==null?void 0:t.trim().toLowerCase(),e=e==null?void 0:e.trim().toLowerCase();const s=this.cols.findIndex(r=>r.name===t);s>=0&&this.rowsArray.length>0&&(this.rowsArray.sort((r,i)=>{const d=r.children[s],h=i.children[s];let a=this.getCellContent(d),n=this.getCellContent(h);if(this.direction==="ascending"){if(a<n)return-1;if(a>n)return 1}else{if(a<n)return 1;if(a>n)return-1}return 0}),this.ths.forEach(r=>{var i;r.classList.remove("sort-ascending"),r.classList.remove("sort-descending"),(r.dataset.sort===t||((i=r.innerText)==null?void 0:i.trim().toLowerCase())===t)&&r.classList.add(`sort-${e}`)}),this.rowsArray.forEach(r=>this.tbody.appendChild(r)))}}customElements.define("action-table",b);
//# sourceMappingURL=action-table.js.map
