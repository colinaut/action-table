var x=Object.defineProperty;var y=(f,m,n)=>m in f?x(f,m,{enumerable:!0,configurable:!0,writable:!0,value:n}):f[m]=n;var b=(f,m,n)=>(y(f,typeof m!="symbol"?m+"":m,n),n);class A extends HTMLElement{constructor(){super();b(this,"options",[])}findOptions(n){n=n.toLowerCase();const t=this.closest("action-table"),r=t.cols,e=t.tbody,h=r.findIndex(s=>s.name===n);if(h===-1)return;const c=`td:nth-child(${h+1})`,u=e.querySelectorAll(c);let i=[];Array.from(u).forEach(s=>{if(s.dataset.filter)i.push(s.dataset.filter);else{const o=s.querySelectorAll("span, ul > li");if((o==null?void 0:o.length)>0){const p=Array.from(o).map(v=>v.innerText);i=i.concat(p)}else i.push(s.innerText)}}),i=Array.from(new Set(i));const a=r[h].order;function l(s){return a!=null&&a.includes(s)?a.indexOf(s).toString():s}i.sort((s,o)=>(s=l(s),o=l(o),t.alphaNumSort(s,o))),this.hasAttribute("descending")&&i.reverse(),this.options=i}connectedCallback(){var t;const n=this.getAttribute("name");n&&(this.hasAttribute("options")?this.options=((t=this.getAttribute("options"))==null?void 0:t.split(","))||[]:this.findOptions(n),this.render(n))}render(n){if(this.options.length<1)return;const t=this.getAttribute("type")||"select";if(t!=="checkbox"&&this.options.length<2)return;const r=this.getAttribute("label")||n,e=this.hasAttribute("multiple")?"multiple":"",h=this.getAttribute("all")||"All";let c="",u="";const i=t==="select"?`<label for="filter-${n}">${r}</label>`:`<span class="filter-label">${r}</span>`;t==="select"&&(c=`<select id="filter-${n}" name="${n}" ${e}><option value="">${h}</option>`,u="</select>"),t==="radio"&&(c=`<label><input name="${n}" type="radio" value="" checked>${h}</label>`);const a=`${i}${c}${this.options.map(l=>t==="select"?`<option value="${l}">${l}</option>`:t==="radio"||t==="checkbox"?`<label><input type="${t}" name="${n}" value="${l}" />${l}</label>`:"").join("")}${u}`;this.innerHTML=`${a}`}}customElements.define("action-table-filter-menu",A);class T extends HTMLElement{connectedCallback(){const m=this.getAttribute("name");m&&(this.innerHTML=`<label>
            <input type="checkbox" name="${m.toLowerCase()}" value="${this.getAttribute("value")||"on"}" />
            <span>${this.getAttribute("label")||m}</span>
          </label>`)}}customElements.define("action-table-filter-switch",T);class L extends HTMLElement{constructor(){super();b(this,"min",0);b(this,"rangeTotal",0);this.render(),this.addEventListeners()}get name(){return this.getAttribute("name")||""}addEventListeners(){this.addEventListener("input",n=>{const t=this.querySelectorAll("input"),r=this.querySelector("output"),[e,h]=Array.from(t).map(a=>Number(a.value)),c=e.toString(),u=h.toString();r instanceof HTMLOutputElement&&(r.textContent=`${c}-${u}`);const i=this.querySelector(".range-slider-highlight");i instanceof HTMLSpanElement&&(i.style.marginLeft=`${(e-this.min)/this.rangeTotal*100}%`,i.style.width=`${(h-e)/this.rangeTotal*100}%`),e>h&&(n.stopPropagation(),t[0].value=u,t[1].value=c)})}findMinMax(){const n=this.getAttribute("min"),t=this.getAttribute("max");if(n&&t)return[Number(n),Number(t)];const r=this.closest("action-table"),e=r.cols,h=r.tbody,c=e.findIndex(a=>a.name===this.name.toLowerCase());if(c===-1)return[0,0];const u=`td:nth-child(${c+1})`,i=h.querySelectorAll(u);return Array.from(i).reduce((a,l)=>{const s=Number(l.actionTable.filter);let o=a.length===2?a[0]:s,p=a.length===2?a[1]:s;return o=o<s?o:s,p=p>s?p:s,[o,p]},[])}render(){const[n,t]=this.findMinMax(),r=n.toString(),e=t.toString();this.rangeTotal=t-n,this.min=n;const h=this.getAttribute("label")||this.name,c=document.createElement("div");c.textContent=h;const u=document.createElement("div");u.classList.add("range-slider-group");const i=Math.pow(10,Math.round(Math.log10(this.rangeTotal)))/10;function a(d,g){for(const E in g)d.setAttribute(E,g[E])}const l=[n];for(let d=n+i;d<=t;d+=i)l.push(Math.round(d/i)*i);l.includes(t)||l.push(t);const s=document.createElementNS("http://www.w3.org/2000/svg","svg");a(s,{role:"presentation",width:"100%",height:"5"});const o=100/(l.length-1);for(let d=1;d<l.length-1;d++){const g=document.createElementNS("http://www.w3.org/2000/svg","line"),E=`${d*o}%`;a(g,{x1:E,x2:E,y1:"0",y2:"5",stroke:"currentColor","stroke-width":"1"}),s.append(g)}const p=document.createElement("span");p.classList.add("range-slider-highlight"),u.append(s,p);for(let d=0;d<=1;d++){const g=document.createElement("input");a(g,{type:"range",name:this.name,min:r,max:e,"data-range":d===0?"min":"max","aria-label":d===0?"Min":"Max",value:d===0?r:e}),u.append(g)}const v=document.createElement("output");v.innerHTML=`${n}&ndash;${t}`,this.append(c,u,v)}}customElements.define("action-table-filter-range",L);class M extends HTMLElement{constructor(){super();b(this,"actionTable",this.closest("action-table"));b(this,"resetButton",this.querySelector("button[type=reset]"));this.addEventListeners()}connectedCallback(){const n=this.actionTable.filters;Object.keys(n).length>0&&this.setFilterElements(n)}toggleHighlight(n){n.value?n.classList.add("selected"):n.classList.remove("selected")}addEventListeners(){var t;this.addEventListener("input",r=>{const e=r.target;if(e instanceof HTMLSelectElement||e instanceof HTMLInputElement){const h=e.hasAttribute("exclusive")||!!e.closest("[exclusive]"),c=e.hasAttribute("regex")||!!e.closest("[regex]"),u=e.hasAttribute("exact")||!!e.closest("[exact]"),i=e.name.toLowerCase();if(e instanceof HTMLSelectElement){this.toggleHighlight(e);const a=Array.from(e.selectedOptions).map(l=>l.value);this.dispatch({[i]:{values:a,exclusive:h,regex:c,exact:u}})}if(e instanceof HTMLInputElement){if(e.type==="checkbox"){const a=this.querySelectorAll("input[type=checkbox][name="+e.name+"]"),l=Array.from(a).filter(s=>s.checked).map(s=>s.value);this.dispatch({[i]:{values:l,exclusive:h,regex:c,exact:u}})}if(e.type==="radio"&&this.dispatch({[i]:{values:[e.value],exclusive:h,regex:c,exact:u}}),e.type==="range"){const a=this.querySelectorAll("input[type=range][name='"+e.name+"']");let l=[];const s=[];a.forEach(o=>{o.dataset.range==="min"&&(s[0]=o.min,l[0]=o.value),o.dataset.range==="max"&&(s[1]=o.max,l[1]=o.value)}),l.every((o,p)=>o===s[p])&&(l=[]),this.dispatch({[i]:{values:l,range:!0}})}}}}),this.querySelectorAll("input[type='search']").forEach(r=>{function e(c,u=300){let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>{c(...a)},u)}}const h=r.dataset.event||"input";r.addEventListener(h,()=>{this.toggleHighlight(r),e(()=>this.dispatch({[r.name]:{values:[r.value]}}))()})}),(t=this.resetButton)==null||t.addEventListener("click",()=>{this.resetAllFilterElements(),this.dispatch()}),this.actionTable.addEventListener("action-table-filters-reset",()=>{this.resetAllFilterElements()})}dispatchInput(n){n.dispatchEvent(new Event("input",{bubbles:!0}))}dispatch(n){if(this.resetButton)if(n){let t=this.actionTable.filters||{};t={...t,...n},this.enableReset(this.hasFilters(t))}else this.enableReset(!1);this.dispatchEvent(new CustomEvent("action-table-filter",{detail:n,bubbles:!0}))}enableReset(n=!0){this.resetButton&&(n?this.resetButton.removeAttribute("disabled"):this.resetButton.setAttribute("disabled",""))}hasFilters(n){return Object.keys(n).some(t=>n[t].values.some(r=>r!==""))}resetAllFilterElements(){this.querySelectorAll("select, input").forEach(t=>{t instanceof HTMLInputElement&&(t.type==="checkbox"||t.type==="radio")&&(t.value===""?t.checked=!0:t.checked=!1),(t instanceof HTMLSelectElement||t instanceof HTMLInputElement&&t.type==="search")&&(t.value="",this.toggleHighlight(t)),t instanceof HTMLInputElement&&t.type==="range"&&(t.value=t.dataset.range==="max"?t.max:t.min,this.dispatchInput(t))})}setFilterElements(n){this.hasFilters(n)?(this.enableReset(),Object.keys(n).forEach(t=>this.setFilterElement(t,n[t].values))):this.resetAllFilterElements()}setFilterElement(n,t){this.querySelectorAll("select, input").forEach(e=>{e.name.toLowerCase()!==n||t.length===0||(e instanceof HTMLSelectElement&&(e.value=t[0],this.toggleHighlight(e)),e instanceof HTMLInputElement&&(e.type==="checkbox"&&t.includes(e.value)&&(e.checked=!0),e.type==="radio"&&e.value===t[0]&&(e.checked=!0),e.type==="search"&&(e.value=t[0],this.toggleHighlight(e)),e.type==="range"&&(e.dataset.range==="min"&&(e.value=t[0]||e.min,this.dispatchInput(e)),e.dataset.range==="max"&&(e.value=t[1]||e.max,this.dispatchInput(e)))))})}}customElements.define("action-table-filters",M);
//# sourceMappingURL=action-table-filters.js.map
