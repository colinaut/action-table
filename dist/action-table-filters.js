var x=Object.defineProperty;var y=(p,m,n)=>m in p?x(p,m,{enumerable:!0,configurable:!0,writable:!0,value:n}):p[m]=n;var E=(p,m,n)=>(y(p,typeof m!="symbol"?m+"":m,n),n);class A extends HTMLElement{constructor(){super();E(this,"options",[])}findOptions(n){n=n.toLowerCase();const t=this.closest("action-table"),r=t.cols,e=t.tbody,c=r.findIndex(s=>s.name===n);if(c===-1)return;const o=`td:nth-child(${c+1})`,u=e.querySelectorAll(o);let i=[];Array.from(u).forEach(s=>{if(s.dataset.filter)i.push(s.dataset.filter);else{const h=s.querySelectorAll("span, ul > li");if((h==null?void 0:h.length)>0){const f=Array.from(h).map(v=>v.innerText);i=i.concat(f)}else i.push(s.innerText)}}),i=Array.from(new Set(i));const a=r[c].order;function l(s){return a!=null&&a.includes(s)?a.indexOf(s).toString():s}i.sort((s,h)=>(s=l(s),h=l(h),t.alphaNumSort(s,h))),this.hasAttribute("descending")&&i.reverse(),this.options=i}connectedCallback(){var t;const n=this.getAttribute("name");n&&(this.hasAttribute("options")?this.options=((t=this.getAttribute("options"))==null?void 0:t.split(","))||[]:this.findOptions(n),this.render(n))}render(n){if(this.options.length<1)return;const t=this.getAttribute("type")||"select",r=this.getAttribute("label")||n,e=this.hasAttribute("multiple")?"multiple":"",c=this.getAttribute("all")||"All";let o="",u="";const i=t==="select"?`<label for="filter-${n}">${r}</label>`:`<span class="filter-label">${r}</span>`;t==="select"&&(o=`<select id="filter-${n}" name="${n}" ${e}><option value="">${c}</option>`,u="</select>"),t==="radio"&&(o=`<label><input name="${n}" type="radio" value="" checked>${c}</label>`);const a=`${i}${o}${this.options.map(l=>t==="select"?`<option value="${l}">${l}</option>`:t==="radio"||t==="checkbox"?`<label><input type="${t}" name="${n}" value="${l}" />${l}</label>`:"").join("")}${u}`;this.innerHTML=`${a}`}}customElements.define("action-table-filter-menu",A);class T extends HTMLElement{constructor(){super(),this.render()}connectedCallback(){this.render()}render(){const m=this.getAttribute("name");if(!m)return;const n=this.getAttribute("label")||m,t=this.getAttribute("value")||"on",r=`<label>
        <input type="checkbox" name="${m.toLowerCase()}" value="${t}" />
        <span>${n}</span>
      </label>`;this.innerHTML=`${r}`}}customElements.define("action-table-filter-switch",T);class L extends HTMLElement{constructor(){super();E(this,"min",0);E(this,"rangeTotal",0);this.render(),this.addEventListeners()}get name(){return this.getAttribute("name")||""}addEventListeners(){this.addEventListener("input",n=>{const t=this.querySelectorAll("input"),r=this.querySelector("output"),[e,c]=Array.from(t).map(a=>Number(a.value)),o=e.toString(),u=c.toString();r instanceof HTMLOutputElement&&(r.textContent=`${o}-${u}`);const i=this.querySelector(".range-slider-highlight");i instanceof HTMLSpanElement&&(i.style.marginLeft=`${(e-this.min)/this.rangeTotal*100}%`,i.style.width=`${(c-e)/this.rangeTotal*100}%`),e>c&&(n.stopPropagation(),t[0].value=u,t[1].value=o)})}findMinMax(){const n=this.getAttribute("min"),t=this.getAttribute("max");if(n&&t)return[Number(n),Number(t)];const r=this.closest("action-table"),e=r.cols,c=r.tbody,o=e.findIndex(a=>a.name===this.name.toLowerCase());if(o===-1)return[0,0];const u=`td:nth-child(${o+1})`,i=c.querySelectorAll(u);return Array.from(i).reduce((a,l)=>{const s=Number(l.actionTable.filter);let h=a.length===2?a[0]:s,f=a.length===2?a[1]:s;return h=h<s?h:s,f=f>s?f:s,[h,f]},[])}render(){const[n,t]=this.findMinMax(),r=n.toString(),e=t.toString();this.rangeTotal=t-n,this.min=n;const c=this.getAttribute("label")||this.name,o=document.createElement("div");o.textContent=c;const u=document.createElement("div");u.classList.add("range-slider-group");const i=Math.pow(10,Math.round(Math.log10(this.rangeTotal)))/10;function a(d,g){for(const b in g)d.setAttribute(b,g[b])}const l=[n];for(let d=n+i;d<=t;d+=i)l.push(Math.round(d/i)*i);l.includes(t)||l.push(t);const s=document.createElementNS("http://www.w3.org/2000/svg","svg");a(s,{role:"presentation",width:"100%",height:"5"});const h=100/(l.length-1);for(let d=1;d<l.length-1;d++){const g=document.createElementNS("http://www.w3.org/2000/svg","line"),b=`${d*h}%`;a(g,{x1:b,x2:b,y1:"0",y2:"5",stroke:"currentColor","stroke-width":"1"}),s.append(g)}const f=document.createElement("span");f.classList.add("range-slider-highlight"),u.append(s,f);for(let d=0;d<=1;d++){const g=document.createElement("input");a(g,{type:"range",name:this.name,min:r,max:e,"data-range":d===0?"min":"max","aria-label":d===0?"Min":"Max",value:d===0?r:e}),u.append(g)}const v=document.createElement("output");v.innerHTML=`${n}&ndash;${t}`,this.append(o,u,v)}}customElements.define("action-table-filter-range",L);class $ extends HTMLElement{constructor(){super();E(this,"actionTable",this.closest("action-table"));this.addEventListeners()}connectedCallback(){const n=this.actionTable.filters;Object.keys(n).length>0&&this.setFilterElements(n)}toggleHighlight(n){n.value?n.classList.add("selected"):n.classList.remove("selected")}addEventListeners(){this.addEventListener("input",r=>{const e=r.target;if(e instanceof HTMLSelectElement||e instanceof HTMLInputElement){const c=e.hasAttribute("exclusive")||!!e.closest("[exclusive]"),o=e.hasAttribute("regex")||!!e.closest("[regex]"),u=e.hasAttribute("exact")||!!e.closest("[exact]"),i=e.name.toLowerCase();if(e instanceof HTMLSelectElement){this.toggleHighlight(e);const a=Array.from(e.selectedOptions).map(l=>l.value);this.dispatch({[i]:{values:a,exclusive:c,regex:o,exact:u}})}if(e instanceof HTMLInputElement){if(e.type==="checkbox"){const a=this.querySelectorAll("input[type=checkbox][name="+e.name+"]"),l=Array.from(a).filter(s=>s.checked).map(s=>s.value);this.dispatch({[i]:{values:l,exclusive:c,regex:o,exact:u}})}if(e.type==="radio"&&this.dispatch({[i]:{values:[e.value],exclusive:c,regex:o,exact:u}}),e.type==="range"){const a=this.querySelectorAll("input[type=range][name='"+e.name+"']"),l=[];a.forEach(s=>{s.dataset.range==="min"&&(l[0]=s.value),s.dataset.range==="max"&&(l[1]=s.value)}),this.dispatch({[i]:{values:l,range:!0}})}}}}),this.querySelectorAll("input[type='search']").forEach(r=>{function e(o,u=300){let i;return(...a)=>{clearTimeout(i),i=setTimeout(()=>{o(...a)},u)}}const c=r.dataset.event||"input";r.addEventListener(c,()=>{this.toggleHighlight(r),e(()=>this.dispatch({[r.name]:{values:[r.value]}}))()})});const t=this.querySelector("button[type=reset]");t==null||t.addEventListener("click",()=>{this.resetAllFilterElements(),this.dispatch()}),this.actionTable.addEventListener("action-table-filters-reset",()=>{this.resetAllFilterElements()})}dispatchInput(n){n.dispatchEvent(new Event("input",{bubbles:!0}))}dispatch(n){this.dispatchEvent(new CustomEvent("action-table-filter",{detail:n,bubbles:!0}))}resetAllFilterElements(){this.querySelectorAll("select, input").forEach(t=>{t instanceof HTMLInputElement&&(t.type==="checkbox"||t.type==="radio")&&(t.value===""?t.checked=!0:t.checked=!1),(t instanceof HTMLSelectElement||t instanceof HTMLInputElement&&t.type==="search")&&(t.value="",this.toggleHighlight(t)),t instanceof HTMLInputElement&&t.type==="range"&&(t.value=t.dataset.range==="max"?t.max:t.min,this.dispatchInput(t))})}setFilterElements(n){Object.keys(n).length>0?Object.keys(n).forEach(t=>{n[t].values&&this.setFilterElement(t,n[t].values)}):this.resetAllFilterElements()}setFilterElement(n,t){this.querySelectorAll("select, input").forEach(e=>{e.name.toLowerCase()!==n||t.length===0||(e instanceof HTMLSelectElement&&(e.value=t[0],this.toggleHighlight(e)),e instanceof HTMLInputElement&&(e.type==="checkbox"&&t.includes(e.value)&&(e.checked=!0),e.type==="radio"&&e.value===t[0]&&(e.checked=!0),e.type==="search"&&(e.value=t[0],this.toggleHighlight(e)),e.type==="range"&&(e.dataset.range==="min"&&(e.value=t[0]||e.min,this.dispatchInput(e)),e.dataset.range==="max"&&(e.value=t[1]||e.max,this.dispatchInput(e)))))})}}customElements.define("action-table-filters",$);
//# sourceMappingURL=action-table-filters.js.map
