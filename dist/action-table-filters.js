var b=Object.defineProperty;var p=(c,i,e)=>i in c?b(c,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[i]=e;var u=(c,i,e)=>(p(c,typeof i!="symbol"?i+"":i,e),e);class d extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","options","label","type","exclusive","multiple"]}get name(){return this.getAttribute("name")||""}get options(){var i;return((i=this.getAttribute("options"))==null?void 0:i.split(","))||[]}set options(i){this.setAttribute("options",i.join(","))}get label(){return this.getAttribute("label")||this.name}get type(){return this.getAttribute("type")||"select"}get multiple(){return this.hasAttribute("multiple")?"multiple":""}findOptions(i){i=i.toLowerCase();const e=this.closest("action-table"),s=e.cols,t=e.tbody,n=s.indexOf(i);if(n===-1)return;const r=`td:nth-child(${n+1})`,o=t.querySelectorAll(r);let l=[];Array.from(o).forEach(a=>{if(a.dataset.filter)l.push(a.dataset.filter);else{const h=a.querySelectorAll("span, ul > li");if((h==null?void 0:h.length)>0){const m=Array.from(h).map(f=>f.innerText);l=l.concat(m)}else l.push(a.innerText)}}),this.options=Array.from(new Set(l))}connectedCallback(){this.options.length<1&&this.findOptions(this.name),this.render()}render(){if(this.options.length<1)return;const i=this.name.toLowerCase(),e=this.type==="select"?`<label for="filter-${i}">${this.label}</label>`:`<span class="filter-label">${this.label}</span>`;let s="",t="";this.type==="select"&&(s=`<select id="filter-${i}" name="${i}" ${this.multiple}><option value="">All</option>`,t="</select>"),this.type==="radio"&&(s=`<label><input name="${i}" type="radio" value="" checked>All</label>`);const n=`${e}${s}${this.options.map(r=>this.type==="select"?`<option value="${r}">${r}</option>`:this.type==="radio"||this.type==="checkbox"?`<label><input type="${this.type}" name="${i}" value="${r}" />${r}</label>`:"").join("")}${t}`;this.innerHTML=`${n}`}}customElements.define("action-table-filter-menu",d);class g extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","label","value"]}get name(){return this.getAttribute("name")||""}get label(){return this.getAttribute("label")||this.name}get value(){return this.getAttribute("value")||"on"}connectedCallback(){this.render()}render(){const i=`<label>
        <input type="checkbox" name="${this.name.toLowerCase()}" value="${this.value}" />
        <span>${this.label}</span>
      </label>`;this.innerHTML=`${i}`}}customElements.define("action-table-filter-switch",g);class y extends HTMLElement{constructor(){super();u(this,"filterElements")}connectedCallback(){this.init()}async init(){await this.checkForActionTableFilterElements(),this.filterElements=this.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=search]"),this.addEventListeners()}toggleHighlight(e){e.value?e.classList.add("selected"):e.classList.remove("selected")}addEventListeners(){const e=this.closest("action-table");this.filterElements.forEach(t=>{const n=!!t.closest("[exclusive]");t.tagName.toLowerCase()==="select"&&t.addEventListener("change",()=>{this.toggleHighlight(t);const o=t,l=Array.from(o.selectedOptions).map(a=>a.value);e.filterTable(t.name,l,n)}),t.type==="checkbox"&&t.addEventListener("change",()=>{const o=Array.from(this.filterElements).filter(l=>(l=l,l.type==="checkbox"&&l.name===t.name?l.checked:!1)).map(l=>l.value);e.filterTable(t.name,o,n)}),t.type==="radio"&&t.addEventListener("change",()=>{e.filterTable(t.name,[t.value])});function r(o,l=300){let a;return(...h)=>{clearTimeout(a),a=setTimeout(()=>{o(...h)},l)}}t.type==="search"&&t.addEventListener("input",()=>{r(()=>e.filterTable(t.name,[t.value]))(),e.filterTable(t.name,[t.value])})});const s=this.querySelector("button[type=reset]");s==null||s.addEventListener("click",()=>{this.resetAllFilterElements(),e.resetFilters()})}async checkForActionTableFilterElements(){const e=this.querySelectorAll("action-table-filter-menu, action-table-filter-switch");return Array.from(e).every(t=>customElements.get(t.tagName.toLowerCase()))?!0:e&&e.length>0?(await Promise.all([customElements.whenDefined("action-table-filter-menu"),customElements.whenDefined("action-table-filter-switch")]),!0):!1}resetAllFilterElements(){this.filterElements.forEach(e=>{if(e.type==="checkbox"||e.type==="radio"){const s=e;s.value===""?s.checked=!0:s.checked=!1}(e.tagName.toLowerCase()==="select"||e.type==="search")&&(e.value="",this.toggleHighlight(e))})}async setFilterElements(e){await this.checkForActionTableFilterElements(),Object.keys(e).length>0?Object.keys(e).forEach(s=>{e[s].values&&this.setFilterElement(s,e[s].values)}):this.resetAllFilterElements()}setFilterElement(e,s){var t;(t=this.filterElements)==null||t.forEach(n=>{if(n.name===e){if(n.type==="checkbox"){const r=n;s.includes(r.value)&&(r.checked=!0)}if(n.tagName.toLowerCase()==="select"&&(n.value=s[0]||"",this.toggleHighlight(n)),n.type==="radio"){const r=n;r.value===s[0]&&(r.checked=!0)}n.type==="search"&&(n.value=s[0]||"",this.toggleHighlight(n))}})}}customElements.define("action-table-filters",y);
//# sourceMappingURL=action-table-filters.js.map
