var b=Object.defineProperty;var f=(a,i,e)=>i in a?b(a,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[i]=e;var m=(a,i,e)=>(f(a,typeof i!="symbol"?i+"":i,e),e);class d extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","options","label","type","exclusive","multiple"]}get name(){return this.getAttribute("name")||""}get options(){var i;return((i=this.getAttribute("options"))==null?void 0:i.split(","))||[]}set options(i){this.setAttribute("options",i.join(","))}get label(){return this.getAttribute("label")||this.name}get type(){return this.getAttribute("type")||"select"}get multiple(){return this.hasAttribute("multiple")?"multiple":""}findOptions(i){i=i.toLowerCase();const e=this.closest("action-table");if(!e)return;const s=e.querySelectorAll("table thead th"),t=Array.from(s).findIndex(h=>{var u;return((u=h.dataset.col)==null?void 0:u.toLowerCase())===i});if(t===-1)return;const n=e.querySelector("table tbody"),l=`td:nth-child(${t+1})`,c=n.querySelectorAll(l),r=n.querySelectorAll(`${l} > span, ${l} > ul > li`);let o=[];r&&r.length>0?o=Array.from(r).map(h=>h.innerText):o=Array.from(c).map(h=>h.dataset.filter||h.innerText),this.options=Array.from(new Set(o))}connectedCallback(){this.options.length<1&&this.findOptions(this.name),this.render()}render(){if(this.options.length<1)return;const i=this.name.toLowerCase(),e=this.type==="select"?`<label for="filter-${i}">${this.label}</label>`:`<span class="filter-label">${this.label}</span>`;let s="",t="";this.type==="select"&&(s=`<select id="filter-${i}" name="${i}" ${this.multiple}><option value="">All</option>`,t="</select>"),this.type==="radio"&&(s=`<label><input name="${i}" type="radio" value="" checked>All</label>`);const n=`${e}${s}${this.options.map(l=>this.type==="select"?`<option value="${l}">${l}</option>`:this.type==="radio"||this.type==="checkbox"?`<label><input type="${this.type}" name="${i}" value="${l}" />${l}</label>`:"").join("")}${t}`;this.innerHTML=`${n}`}}customElements.define("action-table-filter-menu",d);class p extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","label","value"]}get name(){return this.getAttribute("name")||""}get label(){return this.getAttribute("label")||this.name}get value(){return this.getAttribute("value")||"on"}connectedCallback(){this.render()}render(){const i=`<label>
        <input type="checkbox" name="${this.name.toLowerCase()}" value="${this.value}" />
        <span>${this.label}</span>
      </label>`;this.innerHTML=`${i}`}}customElements.define("action-table-filter-switch",p);class g extends HTMLElement{constructor(){super();m(this,"filterElements")}connectedCallback(){this.init()}async init(){await this.checkForActionTableFilterElements(),this.filterElements=this.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=search]"),this.addEventListeners()}toggleHighlight(e){e.value?e.classList.add("selected"):e.classList.remove("selected")}addEventListeners(){const e=this.closest("action-table");this.filterElements.forEach(t=>{const n=!!t.closest("[exclusive]");t.tagName.toLowerCase()==="select"&&t.addEventListener("change",()=>{this.toggleHighlight(t);const c=t,r=Array.from(c.selectedOptions).map(o=>o.value);e.filterTable(t.name,r,n)}),t.type==="checkbox"&&t.addEventListener("change",()=>{const c=Array.from(this.filterElements).filter(r=>(r=r,r.type==="checkbox"&&r.name===t.name?r.checked:!1)).map(r=>r.value);e.filterTable(t.name,c,n)}),t.type==="radio"&&t.addEventListener("change",()=>{e.filterTable(t.name,[t.value])});function l(c,r=300){let o;return(...h)=>{clearTimeout(o),o=setTimeout(()=>{c(...h)},r)}}t.type==="search"&&t.addEventListener("input",()=>{l(()=>e.filterTable(t.name,[t.value]))(),e.filterTable(t.name,[t.value])})});const s=this.querySelector("button[type=reset]");s==null||s.addEventListener("click",()=>{this.resetAllFilterElements(),e.resetFilters()})}async checkForActionTableFilterElements(){const e=this.querySelectorAll("action-table-filter-menu, action-table-filter-switch");return Array.from(e).every(t=>customElements.get(t.tagName.toLowerCase()))?!0:e&&e.length>0?(await Promise.all([customElements.whenDefined("action-table-filter-menu"),customElements.whenDefined("action-table-filter-switch")]),!0):!1}resetAllFilterElements(){this.filterElements.forEach(e=>{if(e.type==="checkbox"||e.type==="radio"){const s=e;s.value===""?s.checked=!0:s.checked=!1}(e.tagName.toLowerCase()==="select"||e.type==="search")&&(e.value="",this.toggleHighlight(e))})}async setFilterElements(e){await this.checkForActionTableFilterElements(),Object.keys(e).length>0?Object.keys(e).forEach(s=>{e[s].values&&this.setFilterElement(s,e[s].values)}):this.resetAllFilterElements()}setFilterElement(e,s){var t;(t=this.filterElements)==null||t.forEach(n=>{if(n.name===e){if(n.type==="checkbox"){const l=n;s.includes(l.value)&&(l.checked=!0)}if(n.tagName.toLowerCase()==="select"&&(n.value=s[0]||"",this.toggleHighlight(n)),n.type==="radio"){const l=n;l.value===s[0]&&(l.checked=!0)}n.type==="search"&&(n.value=s[0]||"",this.toggleHighlight(n))}})}}customElements.define("action-table-filters",g);
//# sourceMappingURL=action-table-filters.js.map
