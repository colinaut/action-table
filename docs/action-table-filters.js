var v=Object.defineProperty;var y=(f,m,e)=>m in f?v(f,m,{enumerable:!0,configurable:!0,writable:!0,value:e}):f[m]=e;var b=(f,m,e)=>(y(f,typeof m!="symbol"?m+"":m,e),e);class A extends HTMLElement{constructor(){super();b(this,"options",[])}findOptions(e){e=e.toLowerCase();const t=this.closest("action-table"),a=t.cols,n=t.tbody,u=a.findIndex(s=>s.name===e);if(u===-1)return;const c=`td:nth-child(${u+1})`,h=n.querySelectorAll(c);let i=[];Array.from(h).forEach(s=>{if(s.dataset.filter)i.push(s.dataset.filter);else{const l=s.querySelectorAll("span, ul > li");if((l==null?void 0:l.length)>0){const p=Array.from(l).map(x=>x.innerText);i=i.concat(p)}else i.push(s.innerText)}}),i=Array.from(new Set(i));const r=a[u].order;function o(s){return r!=null&&r.includes(s)?r.indexOf(s).toString():s}i.sort((s,l)=>(s=o(s),l=o(l),t.alphaNumSort(s,l))),this.hasAttribute("descending")&&i.reverse(),this.options=i}connectedCallback(){var t;const e=this.getAttribute("name");e&&(this.hasAttribute("options")?this.options=((t=this.getAttribute("options"))==null?void 0:t.split(","))||[]:this.findOptions(e),this.render(e))}render(e){if(this.options.length<1)return;const t=this.getAttribute("type")||"select";if(t!=="checkbox"&&this.options.length<2)return;const a=this.getAttribute("label")||e,n=this.hasAttribute("multiple")?"multiple":"",u=this.getAttribute("all")||"All";let c="",h="";const i=t==="select"?`<label for="filter-${e}">${a}</label>`:`<span class="filter-label">${a}</span>`;t==="select"&&(c=`<select id="filter-${e}" name="${e}" ${n}><option value="">${u}</option>`,h="</select>"),t==="radio"&&(c=`<label><input name="${e}" type="radio" value="" checked>${u}</label>`);const r=`${i}${c}${this.options.map(o=>t==="select"?`<option value="${o}">${o}</option>`:t==="radio"||t==="checkbox"?`<label><input type="${t}" name="${e}" value="${o}" />${o}</label>`:"").join("")}${h}`;this.innerHTML=`${r}`}}customElements.define("action-table-filter-menu",A);class T extends HTMLElement{connectedCallback(){const m=this.getAttribute("name");m&&(this.innerHTML=`<label>
            <input type="checkbox" name="${m.toLowerCase()}" value="${this.getAttribute("value")||"on"}" />
            <span>${this.getAttribute("label")||m}</span>
          </label>`)}}customElements.define("action-table-filter-switch",T);class L extends HTMLElement{constructor(){super();b(this,"min",0);b(this,"rangeTotal",0);this.render(),this.addEventListeners()}get name(){return this.getAttribute("name")||""}addEventListeners(){this.addEventListener("input",e=>{const t=this.querySelectorAll("input"),a=this.querySelector("output"),[n,u]=Array.from(t).map(r=>Number(r.value)),c=n.toString(),h=u.toString();a instanceof HTMLOutputElement&&(a.textContent=`${c}-${h}`);const i=this.querySelector(".range-slider-highlight");i instanceof HTMLSpanElement&&(i.style.marginLeft=`${(n-this.min)/this.rangeTotal*100}%`,i.style.width=`${(u-n)/this.rangeTotal*100}%`),n>u&&(e.stopPropagation(),t[0].value=h,t[1].value=c)})}findMinMax(){const e=this.getAttribute("min"),t=this.getAttribute("max");if(e&&t)return[Number(e),Number(t)];const a=this.closest("action-table"),n=a.cols,u=a.tbody,c=n.findIndex(r=>r.name===this.name.toLowerCase());if(c===-1)return[0,0];const h=`td:nth-child(${c+1})`,i=u.querySelectorAll(h);return Array.from(i).reduce((r,o)=>{const s=Number(o.actionTable.filter);let l=r.length===2?r[0]:s,p=r.length===2?r[1]:s;return l=l<s?l:s,p=p>s?p:s,[l,p]},[])}render(){const[e,t]=this.findMinMax(),a=e.toString(),n=t.toString();this.rangeTotal=t-e,this.min=e;const u=this.getAttribute("label")||this.name,c=document.createElement("div");c.textContent=u;const h=document.createElement("div");h.classList.add("range-slider-group");const i=Math.pow(10,Math.round(Math.log10(this.rangeTotal)))/10;function r(d,g){for(const E in g)d.setAttribute(E,g[E])}const o=[e];for(let d=e+i;d<=t;d+=i)o.push(Math.round(d/i)*i);o.includes(t)||o.push(t);const s=document.createElementNS("http://www.w3.org/2000/svg","svg");r(s,{role:"presentation",width:"100%",height:"5"});const l=100/(o.length-1);for(let d=1;d<o.length-1;d++){const g=document.createElementNS("http://www.w3.org/2000/svg","line"),E=`${d*l}%`;r(g,{x1:E,x2:E,y1:"0",y2:"5",stroke:"currentColor","stroke-width":"1"}),s.append(g)}const p=document.createElement("span");p.classList.add("range-slider-highlight"),h.append(s,p);for(let d=0;d<=1;d++){const g=document.createElement("input");r(g,{type:"range",name:this.name,min:a,max:n,"data-range":d===0?"min":"max","aria-label":d===0?"Min":"Max",value:d===0?a:n}),h.append(g)}const x=document.createElement("output");x.innerHTML=`${e}&ndash;${t}`,this.append(c,h,x)}}customElements.define("action-table-filter-range",L);class S extends HTMLElement{constructor(){super();b(this,"actionTable",this.closest("action-table"));b(this,"resetButton",this.querySelector("button[type=reset]"));this.addEventListeners()}connectedCallback(){const e=this.actionTable.filters;Object.keys(e).length>0&&this.setFilterElements(e)}toggleHighlight(e){e.value?e.classList.add("selected"):e.classList.remove("selected")}addEventListeners(){var t;this.addEventListener("input",a=>{const n=a.target;if(n instanceof HTMLSelectElement||n instanceof HTMLInputElement){const u=n.hasAttribute("exclusive")||!!n.closest("[exclusive]"),c=n.hasAttribute("regex")||!!n.closest("[regex]"),h=n.hasAttribute("exact")||!!n.closest("[exact]"),i=n.name.toLowerCase();if(n instanceof HTMLSelectElement){this.toggleHighlight(n);const r=Array.from(n.selectedOptions).map(o=>o.value);this.dispatch({[i]:{values:r,exclusive:u,regex:c,exact:h}})}if(n instanceof HTMLInputElement){if(n.type==="checkbox"){const r=this.querySelectorAll("input[type=checkbox][name="+n.name+"]"),o=Array.from(r).filter(s=>s.checked).map(s=>s.value);this.dispatch({[i]:{values:o,exclusive:u,regex:c,exact:h}})}if(n.type==="radio"&&this.dispatch({[i]:{values:[n.value],exclusive:u,regex:c,exact:h}}),n.type==="range"){const r=this.querySelectorAll("input[type=range][name='"+n.name+"']");let o=[];const s=[];r.forEach(l=>{l.dataset.range==="min"&&(s[0]=l.min,o[0]=l.value),l.dataset.range==="max"&&(s[1]=l.max,o[1]=l.value)}),o.every((l,p)=>l===s[p])&&(o=[]),this.dispatch({[i]:{values:o,range:!0}})}}}}),this.querySelectorAll("input[type='search']").forEach(a=>{function n(c,h=300){let i;return(...r)=>{clearTimeout(i),i=setTimeout(()=>{c(...r)},h)}}const u=a.dataset.event||"input";a.addEventListener(u,()=>{this.toggleHighlight(a),n(()=>this.dispatch({[a.name]:{values:[a.value]}}))()})}),(t=this.resetButton)==null||t.addEventListener("click",()=>{this.resetAllFilterElements(),this.dispatch()}),this.actionTable.addEventListener("action-table-filters-reset",()=>{this.resetAllFilterElements()})}dispatchInput(e){e.dispatchEvent(new Event("input",{bubbles:!0}))}dispatch(e){if(this.resetButton)if(e){let t=this.actionTable.filters||{};t={...t,...e},this.enableReset(this.hasFilters(t))}else this.enableReset(!1);this.dispatchEvent(new CustomEvent("action-table-filter",{detail:e,bubbles:!0}))}enableReset(e=!0){this.resetButton&&(e?this.resetButton.removeAttribute("disabled"):this.resetButton.setAttribute("disabled",""))}hasFilters(e){return Object.keys(e).some(t=>e[t].values.some(a=>a!==""))}resetAllFilterElements(){this.querySelectorAll("select, input").forEach(t=>{t instanceof HTMLInputElement&&(t.type==="checkbox"||t.type==="radio")&&(t.value===""?t.checked=!0:t.checked=!1),(t instanceof HTMLSelectElement||t instanceof HTMLInputElement&&t.type==="search")&&(t.value="",this.toggleHighlight(t)),t instanceof HTMLInputElement&&t.type==="range"&&(t.value=t.dataset.range==="max"?t.max:t.min,this.dispatchInput(t))})}setFilterElements(e){this.hasFilters(e)?(this.enableReset(),Object.keys(e).forEach(t=>this.setFilterElement(t,e[t].values))):this.resetAllFilterElements()}setSelectValueIgnoringCase(e,t){t=t.toLowerCase(),Array.from(e.options).some(a=>(a.value.toLowerCase()||a.text.toLowerCase())===t?(a.selected=!0,this.toggleHighlight(e),!0):!1)}setFilterElement(e,t){if(t.length===0)return;this.querySelectorAll(`select[name="${e}" i], input[name="${e}" i]`).forEach(n=>{n instanceof HTMLSelectElement&&(n.value=t[0],this.setSelectValueIgnoringCase(n,t[0])),n instanceof HTMLInputElement&&(n.type==="checkbox"&&t.includes(n.value)&&(n.checked=!0),n.type==="radio"&&n.value===t[0]&&(n.checked=!0),n.type==="search"&&(n.value=t[0],this.toggleHighlight(n)),n.type==="range"&&(n.dataset.range==="min"&&(n.value=t[0]||n.min,this.dispatchInput(n)),n.dataset.range==="max"&&(n.value=t[1]||n.max,this.dispatchInput(n))))})}}customElements.define("action-table-filters",S);
//# sourceMappingURL=action-table-filters.js.map
