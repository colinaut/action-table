var m=Object.defineProperty;var p=(o,i,e)=>i in o?m(o,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[i]=e;var b=(o,i,e)=>(p(o,typeof i!="symbol"?i+"":i,e),e);class f extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","options","label","type","exclusive","multiple"]}get name(){return this.getAttribute("name")||""}get options(){return this.getAttribute("options")||""}set options(i){this.setAttribute("options",i)}get label(){return this.getAttribute("label")||this.name}get type(){return this.getAttribute("type")||"select"}get multiple(){return this.hasAttribute("multiple")?"multiple":""}findOptions(i){var c,h,u;i=i.toLowerCase();const e=(c=this.closest("action-table"))==null?void 0:c.querySelectorAll("table thead th"),s=Array.from(e).findIndex(r=>{var a;return((a=r.dataset.col)==null?void 0:a.toLowerCase())===i||r.innerText.toLowerCase()===i});if(s===-1)return;const l=(h=this.closest("action-table"))==null?void 0:h.querySelectorAll(`table tbody td:nth-child(${s+1})`),n=(u=this.closest("action-table"))==null?void 0:u.querySelectorAll(`table tbody td:nth-child(${s+1}) > *`);let t=[];n&&n.length>0?t=Array.from(n).map(r=>r.matches("[type='checkbox']")?r.value:r.innerText):t=Array.from(l).map(r=>r.dataset.filter||r.innerText),this.options=Array.from(new Set(t)).join(",")}connectedCallback(){this.options||this.findOptions(this.name),this.render()}render(){const i=this.name.toLowerCase(),e=this.type==="select"?`<label for="filter-${i}">${this.label}</label>`:`<span class="filter-label">${this.label}</span>`;let s="",l="";this.type==="select"&&(s=`<select id="filter-${i}" name="${i}" ${this.multiple}><option value="">All</option>`,l="</select>"),this.type==="radio"&&(s=`<label><input name="${i}" type="radio" value="">All</label>`);let n=`${e}${s}${this.options.split(",").map(t=>this.type==="select"?`<option value="${t}">${t}</option>`:this.type==="radio"||this.type==="checkbox"?`<label><input type="${this.type}" name="${i}" value="${t}" />${t}</label>`:"").join("")}${l}`;this.innerHTML=`${n}`}}customElements.define("action-table-filter-menu",f);class d extends HTMLElement{constructor(){super()}static get observedAttributes(){return["name","label","value"]}get name(){return this.getAttribute("name")||""}get label(){return this.getAttribute("label")||this.name}get value(){return this.getAttribute("value")||"on"}connectedCallback(){this.render()}render(){const i=`<label>
        <input type="checkbox" name="${this.name.toLowerCase()}" value="${this.value}" />
        <span>${this.label}</span>
      </label>`;this.innerHTML=`${i}`}}customElements.define("action-table-filter-switch",d);class y extends HTMLElement{constructor(){super();b(this,"filterElements")}connectedCallback(){this.init()}async init(){await this.checkForActionTableFilterElements(),this.filterElements=this.querySelectorAll("select, input[type=checkbox], input[type=radio], input[type=search]"),this.addEventListeners()}toggleHighlight(e){e.value?e.classList.add("selected"):e.classList.remove("selected")}addEventListeners(){const e=this.closest("action-table");this.addEventListener("change",n=>{const t=n.target;let c="";if(t.type==="checkbox"){const u=t,r=Array.from(this.filterElements).filter(a=>(a=a,a.type==="checkbox"&&a.name===u.name?a.checked:!1)).map(a=>a.value);r.length>0&&(c=r)}if(t.type==="radio"&&(c=t.value),t.tagName.toLowerCase()==="select"){const u=t;c=Array.from(u.selectedOptions).map(a=>a.value)}const h=!!t.closest("[exclusive]");e.filterTable(t.name,c,h),this.toggleHighlight(t)});function s(n,t=300){let c;return(...h)=>{clearTimeout(c),c=setTimeout(()=>{n(h)},t)}}this.addEventListener("input",n=>{const t=n.target;if(t.type!=="search")return;s(()=>e.filterTable(t.name,t.value,!1))()});const l=this.querySelector("button[type=reset]");l==null||l.addEventListener("click",()=>{this.resetAllFilterElements(),e.resetFilters()})}async checkForActionTableFilterElements(){const e=this.querySelectorAll("action-table-filter-menu, action-table-filter-switch");return e&&e.length>0?(await Promise.all([customElements.whenDefined("action-table-filter-menu"),customElements.whenDefined("action-table-filter-switch")]),!0):!1}resetAllFilterElements(){this.filterElements.forEach(e=>{if(e.type==="checkbox"||e.type==="radio"){const s=e;s.value===""?s.checked=!0:s.checked=!1}(e.tagName.toLowerCase()==="select"||e.type==="search")&&(e.value="",this.toggleHighlight(e))})}async setFilterElements(e){await this.checkForActionTableFilterElements(),Object.keys(e).forEach(s=>{this.setFilterElement(s,e[s])})}setFilterElement(e,s){this.filterElements.forEach(l=>{if(l.name===e){if(l.type==="checkbox"&&Array.isArray(s)){const n=l;s.includes(n.value)&&(n.checked=!0)}if(typeof s=="string"){if(l.type==="radio"){const n=l;n.value===s&&(n.checked=!0)}(l.tagName.toLowerCase()==="select"||l.type==="search")&&(l.name===e&&(l.value=s),this.toggleHighlight(l))}}})}}customElements.define("action-table-filters",y);
//# sourceMappingURL=action-table-filters.js.map
